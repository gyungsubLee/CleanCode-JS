# 59. ìˆœìˆ˜ í•¨ìˆ˜

> [Redux DOC - Rules of Reducers/side effect, pure fucntion ì •ì˜ ì°¸ì¡°](https://ko.redux.js.org/tutorials/fundamentals/part-3-state-actions-reducers)

![image](https://user-images.githubusercontent.com/95308384/202847193-b3cbe284-f0c9-47ab-8399-7620982a1c07.png)

reduxì˜ DOCì—ì„œ Reducersë“¤ì˜ ê·œì¹™ì— ì •ì˜ëœ íŠ¹ìˆ˜í•œ ê·œì¹™ë“¤ê³¼

![image](https://user-images.githubusercontent.com/95308384/202847218-b47e78c2-920f-485c-8a59-ffb9beb68c05.png)

ì´ëŸ¬í•œ ê·œì¹™ë“¤ì„ ë”°ë¥´ëŠ” í•¨ìˆ˜ë¥¼ `ìˆœìˆ˜ í•¨ìˆ˜(pure function)`ë¼ê³  í•œë‹¤.

<br/>

> ### ğŸ¤” side effect(ë¶€ìˆ˜ íš¨ê³¼)ë€?
>
> ![image](https://user-images.githubusercontent.com/95308384/202846737-dcd50e03-d525-478a-86b0-daf434364a3e.png)
>
> "side effect"ë€ í•¨ìˆ˜ì—ì„œ ê°’ì„ ë°˜í™˜í•˜ëŠ” ê²ƒ ì™¸ì— ë³¼ ìˆ˜ ìˆëŠ” ìƒíƒœ ë˜ëŠ” ë™ì‘ì— ëŒ€í•œ ë³€ê²½ ì‚¬í•­ì´ë‹¤.
>
> â— consoleì— value ë¡œê¹… [`console.log(value)`]<br/>
> â— íŒŒì¼ ì €ì¥<br/>
> â— ë¹„ë™ê¸° íƒ€ì´ë¨¸ ì„¤ì •<br/>
> â— AJAX HTTP ìš”ì²­<br/>
> â— í•¨ìˆ˜ ì™¸ë¶€ì— ì¡´ì¬í•˜ëŠ” ì¼ë¶€ State ìˆ˜ì • ë° í•¨ìˆ˜ì— ëŒ€í•œ arguments ë³€ê²½<br/>
> â— ì¼ë¹ˆì ì¸ ëœë¤ ìˆ«ì or íŠ¹ìˆ˜í•œ ëœë˜ IDë“¤(`Math.random()` or `Date.now()`)<br/>
>
> Reference)
> https://ko.redux.js.org/tutorials/fundamentals/part-3-state-actions-reducers > <br/>

<br/>
<br/>

## Case1 - impure Function(ë¹„ìˆœìˆ˜ í•¨ìˆ˜)

```javascript
let num1 = 10;
let num2 = 20;

function impureSum1() {
  return num1 + num2;
}

impureSum1(); // 30

num1 = 30;

impureSum1(); // 50
```

`ìˆœìˆ˜ í•¨ìˆ˜`ëŠ” `ë™ì¼í•œ ì¸ìë¥¼ ë°›`ìœ¼ë©´ `ë™ì¼í•œ ê°’ì´ return` ë˜ì–´ì•¼í•œë‹¤. ìœ„ ê²½ìš° ì¸ìê°€ ë³€í•˜ì§€ ì•Šì•˜ê¸°ë•Œë¬¸ì— í˜¸ì¶œ ì‹œ ë™ì¼í•œ ê°’ì´ return ë˜ì–´ì•¼í•˜ì§€ë§Œ ê·¸ë ‡ì§€ì•Šë‹¤.
ìœ„ì—ì„œ ì •ì˜í•œ side effectì˜ `ì™¸ë¶€ stateë¥¼ ì°¸ì¡°`ì˜ ê²½ìš°ì— í•´ë‹¹ë˜ë©°
ë”°ë¼ì„œ í•´ë‹¹ í•¨ìˆ˜ëŠ” s`ide effectë¥¼ ê°€`ì§€ëŠ”` ë¹„ìˆœìˆ˜(impure) í•¨ìˆ˜`ì´ë‹¤.

<br/>

```javascript
let num1 = 30;

function impureSum2(newNum) {
  return num1 + newNum;
}

impureSum2(30); // 30

num1 = 100;

impureSum2(30); // 130
```

ìœ„ì™€ ë™ì¼í•œ ê²½ìš°ë¡œ ì™¸ë¶€ stateë¥¼ ì°¸ì¡°í•´ ë™ì¼í•œ ì¸ì ê°’ì—ì„œ ë™ì¼í•œ ê²°ê³¼ê°’ì´ ë„ì¶œë˜ì§€ ì•ŠëŠ”ë‹¤.

<br/>

### `ìˆœìˆ˜(pure) í•¨ìˆ˜`

```javascript
function pureSum(num1, num2) {
  return num1 + num2;
}

pureSum(10, 20); // 30
pureSum(10, 20); // 30

pureSum(30, 100); // 130
pureSum(30, 100); // 130
```

ìœ„ì˜ impure(ë¹„ìˆœìˆ˜) í•¨ìˆ˜ë“¤ì„ pureí•˜ê²Œ ë³€ê²½í•œ ë¡œì§ì´ë‹¤.

`ì™¸ë¶€ stateì— ëŒ€í•œ ì°¸ì¡°` ë¡œì§ì„ ì—†ì• ê³  ëª¨ë‘ `argumentë¡œ ì²˜ë¦¬`í•˜ì—¬ `side effectê°€ ì œê±°`ë˜ì—ˆë‹¤. (`í•¨ìˆ˜ ë‚´ ì§€ì—­ ë³€ìˆ˜(state) ë° ì™¸ë¶€ ë³€ìˆ˜(state) ì°¸ì¡°í•˜ëŠ” ë°ì´í„°`ë¥¼ `argument` ì™€ `return ê°’`ìœ¼ë¡œ ì²˜ë¦¬)

ë”°ë¼ì„œ ë™ì¼í•œ ì¸ìë¥¼ ë°›ì„ ì‹œ, ë™ì¼í•œ ê°’ì´ return ëœë‹¤.(ìˆœìˆ˜ í•¨ìˆ˜)

<br/>
<br/>

## Case2 - Primitive Type VS Reference Type - ìˆœìˆ˜ í•¨ìˆ˜

### Primitive Type

```javascript
function changeValue(num) {
  num++;

  return num;
}

changeValue(1); // 2
changeValue(4); // 5
```

Primitive Type(number, string ...)ì€ `ì‹¤ì œ ê°’ì„ ë³µì‚¬(real copy)`í•œë‹¤.

<br/>

### Reference Type (`shallow copy`)

```javascript
const obj = { one: 1 };

// ê°ì²´, ë°°ì—´ => ìƒˆë¡­ê²Œ ë§Œë“¤ì–´ì„œ ë°˜í™˜
function changeObj(targetObj) {
  targetObj.one = 100;

  return targetObj;
}

changeObj(obj); // { one: 100}

obj; // { one: 100}, ì¸ìë¡œ ë°›ëŠ” ì™¸ë¶€ Stateê°€ ìˆ˜ì •ë¨. (side effect)
```

ìë°”ìŠ¤í¬ë¦½íŠ¸ì—ì„œì˜ `Reference Typeì¸ Object`ëŠ” `ì¸ìë¡œ ë°›ëŠ” ì™¸ë¶€ Stateë¥¼ í•¨ìˆ˜ ë‚´ë¶€ì—ì„œ ìˆ˜ì •` ì‹œ `ì™¸ë¶€ í•¨ìˆ˜ê¹Œì§€ ìˆ˜ì •`ë˜ëŠ” `side effect`ê°€ ë°œìƒí•˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

ì´ëŸ¬í•œ ì´ìœ ëŠ” Reference Typeì€ Primitive Typeê³¼ëŠ” ë‹¬ë¦¬` ë©”ëª¨ë¦¬ ì£¼ì†Œ ê°’ì„ ì°¸ì¡°`([Shallow copy](https://www.geeksforgeeks.org/what-is-shallow-copy-in-javascript/))í•˜ì—¬ `CRUD ì‹œ ì›ë³¸ ê°’ê¹Œì§€ ë³€ê²½`ëœë‹¤.

ë”°ë¼ì„œ reference type(Object, Array ...)ì€ `CRUDì‹œ` `ìƒˆë¡œìš´ Objectë¥¼ ë§Œë“¤ì–´ì„œ ë°˜í™˜` í•´ì•¼í•œë‹¤. <br/>(`spread ì—°ì‚°ì(...)`ë¥¼ ì´ìš©í•œ `deep copy`ë¡œ ë³€ê²½)

<br/>

### ìƒˆë¡œìš´ ê°ì²´ ë³µì‚¬ ë° ì—…ë°ì´íŠ¸ (`deep copy`)

```javascript
const obj = { one: 1 };

function changeObj(targetObj) {
  targetObj.one = 100;

  return { ...targetOnj, one: 100 };
}

changeObj(obj); // { one: 100}
obj; // { one: 1}
```

ìœ„ì™€ ê°™ì´ `spread ì—°ì‚°ì(...)`ë¥¼ ì‚¬ìš©í•˜ì—¬ `ê¸°ì¡´ ê°ì²´ ê°’ì„ ë³µì‚¬(deep copy)` ë° `Update ë°ì´í„°ë¥¼ ì¶”ê°€`ì‹œí‚¨ `ìƒˆë¡œìš´ Objectë¥¼ ë§Œë“¤ì–´ì„œ ë°˜í™˜` ì²˜ë¦¬í•œë‹¤.

ë”°ë¼ì„œ ì›ë³¸ ê°’ì´ ìˆ˜ì •ë˜ëŠ” ì˜¤ë¥˜ê°€ í•´ê²°ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆë‹¤.

<br/>
<br/>

## ì •ë¦¬)

ìˆœìˆ˜ í•¨ìˆ˜ë€, side effectê°€ ì—†ëŠ” í•¨ìˆ˜ì´ë‹¤.

> ### Side Effect
>
> â— consoleì— value ë¡œê¹… [console.log(value)]<br/>
> â— íŒŒì¼ ì €ì¥<br/>
> â— ë¹„ë™ê¸° íƒ€ì´ë¨¸ ì„¤ì •<br/>
> â— AJAX HTTP ìš”ì²­<br/>
> â— í•¨ìˆ˜ ì™¸ë¶€ì— ì¡´ì¬í•˜ëŠ” ì¼ë¶€ State ìˆ˜ì • ë° í•¨ìˆ˜ì— ëŒ€í•œ arguments ë³€ê²½<br/>
> â— ì¼ë¹ˆì ì¸ ëœë¤ ìˆ«ì or íŠ¹ìˆ˜í•œ ëœë˜ IDë“¤(Math.random() or Date.now())<br/>

Case 1 - ë¹„ìˆœìˆ˜í•¨ìˆ˜ -> ìˆœìˆ˜í•¨ìˆ˜ [side effect ì œê±°]

Case 2 -` Reference Type(Object)` - ë¹„ìˆœìˆ˜ í•¨ìˆ˜(`shallow copy`) -> ìˆœìˆ˜ í•¨ìˆ˜(`deep copy`)

<br/>

Reference)<br/>
https://www.udemy.com/course/clean-code-js/learn/lecture/30078338#announcements<br/>
https://ko.redux.js.org/tutorials/fundamentals/part-3-state-actions-reducers<br/>
https://www.geeksforgeeks.org/what-is-shallow-copy-in-javascript/<br/>
https://javascript.plainenglish.io/shallow-copy-and-deep-copy-in-javascript-a0a04104ab5c
